<section class="ten columns offset-by-one" data-ng-init="sqCtrl.reporter.retrieveSightings(); sqCtrl.TreeService.retrieve();">

  <ui-gmap-google-map id="squirrel-map" center="sqCtrl.map.center" zoom="sqCtrl.map.zoom" options="sqCtrl.map.options" events="sqCtrl.map.events">

    <ui-gmap-marker data-ng-repeat="sighting in sqCtrl.reporter.sightings"
        coords="{latitude:sighting.loc[1], longitude:sighting.loc[0]}"
        idKey="sighting.date"
        options="{icon:'/../assets/squirrel.png'}"
        click="sqCtrl.infowindowConfig.onClick(sighting._id)"  >

      <ui-gmap-window
          coords="{latitude:sighting.loc[1], longitude:sighting.loc[0]}"
          show="sqCtrl.infowindowConfig.selected === sighting._id"
          closeClick="sqCtrl.infowindowConfig.closeClick()">
        <div>
          <h3>squirrel sighting !!</h3>
          reporter: {{sighting.reporter}} <br/>
          coordinates: {{sighting.loc[1]}}, {{sighting.loc[0]}} </br>
          date: {{sighting.date | date:'medium'}}
        </div>
      </ui-gmap-window>

    </ui-gmap-marker>

    <ui-gmap-marker data-ng-repeat="search in sqCtrl.TreeService.trees"
        coords="{latitude:search.tree.lat, longitude:search.tree.lng}"
        idKey="search.search._id"
        options="{icon:'/../assets/tree.png'}"
        click="sqCtrl.infowindowConfig.onClick(search._id)"  >

      <ui-gmap-window style="max-width:200px"
          coords="{latitude:search.tree.lat, longitude:search.tree.lng}"
          show="sqCtrl.infowindowConfig.selected === search.search._id"
          closeClick="sqCtrl.infowindowConfig.closeClick()">
        <div>
          {{search.tree.cityID}} </br>
          {{search.tree.lat}}, {{search.tree.lng}} </br>
          {{search.tree.species.genus}} {{search.tree.species.species}} - {{search.tree.species.commonName}}

        </br>
          <img src={{search.search.imgSrc}} style="max-width:200px"></img>
        </div>
      </ui-gmap-window>


    </ui-gmap-marker>

    <ui-gmap-marker ng-if="sqCtrl.reporter.mapClickCoords.latitude && sqCtrl.reporter.mapClickCoords.longitude"
        coords="{latitude:sqCtrl.reporter.mapClickCoords.latitude, longitude:sqCtrl.reporter.mapClickCoords.longitude}"
        idKey="'new_sighting'"
        options="{icon:'/../assets/squirrel-fur.png'}" >

    </ui-gmap-marker>

    <ui-gmap-map-control template="views/report-a-squirrel.html" index="-1" position="top-right"></ui-gmap-map-control>

  </ui-gmap-google-map>

</section>
